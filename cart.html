<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Cart - Jai Sri Ram Bull Driven Oils</title>
    <link rel="stylesheet" href="cart.css">
</head>
<body>
    <nav>
        <div class="logo">
            <div class="logo-circle">
                <img src="img/bull.png" alt="Ram Logo">
            </div>
            <span>Jai Sri Ram Bull Driven Oils</span>
        </div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="products.html">Products</a></li>
            <li><a href="cart.html" class="active">Cart</a></li>
        </ul>
    </nav>

    <section class="cart-section">
        <h1>Your Shopping Cart</h1>
        <div class="cart-container">
            <table id="cart-table">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Price</th>
                        <th>Qty</th>
                        <th>Total</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="cart-body"></tbody>
            </table>
            <div id="empty-message">Your cart is empty.</div>
        </div>

        <div class="cart-summary">
            <h3>Grand Total: ₹<span id="grand-total">0</span></h3>

            <div class="delivery-section">
                <h4>Delivery Details</h4>
                <input type="text" id="customer-name" placeholder="Full Name" required>
                <input type="tel" id="customer-contact" placeholder="Contact Number" required>
                <input type="email" id="customer-email" placeholder="Email" required>
                <select id="customer-country" onchange="populateStates()" required>
                    <option value="">Select Country</option>
                    <option value="India">India</option>
                    <option value="USA">USA</option>
                    <option value="Australia">Australia</option>
                </select>
                <select id="customer-state" required>
                    <option value="">Select State</option>
                </select>
                <input type="text" id="customer-city" placeholder="City" required>
                <input type="text" id="customer-pincode" placeholder="Pincode" required>
                <textarea id="customer-address" rows="3" placeholder="Full Address" required></textarea>
            </div>

            <button class="checkout-btn" onclick="proceedUPIPayment()">Checkout & Pay</button>
            <div id="payment-section" style="display:none; margin-top: 20px; text-align:center;"></div>

            <button class="clear-btn" onclick="clearCart()">Clear Cart</button>
        </div>
    </section>

    <section class="custom-oil-section">
        <h2>Custom Bull-Driven Oil Orders</h2>
        <p>
            Any oil can be freshly extracted on requirement basis. 
            We also accept custom orders where you can choose the seeds 
            and the quantity you need. All types of seeds can be crushed 
            and turned into pure bull-driven oils based on your preference.
        </p>
        <a href="https://wa.me/917095924929" target="_blank" class="whatsapp-btn">Contact on WhatsApp</a>
    </section>

    <footer class="custom-footer">
        <div>
            <h3>Jai Sri Ram Bull Driven Oils</h3>
            <p><strong>Mobile:</strong> <a href="tel:+917095924929">+91 70959 24929</a></p>
            <p><strong>Whatsapp:</strong> <a href="https://wa.me/917095924929">Contact on WhatsApp</a></p>
            <p><strong>Email:</strong> <a href="mailto:jaishrirambulldrivenoils@gmail.com">jaishrirambulldrivenoils@gmail.com</a></p>
            <p><strong>Location:</strong> <a href="https://www.google.com/maps/place/Jai+sriram+bull+driven+oils/" target="_blank">View on Google Maps</a></p>
            <p>&copy; 2025 Jai Sri Ram Bull Driven Oils</p>
        </div>
    </footer>

    <script>const countryStates = {
    "India": ["Andhra Pradesh","Telangana","Karnataka","Maharashtra","Tamil Nadu","Delhi","West Bengal"],
    "USA": ["California","Texas","Florida","New York","Illinois"],
    "Australia": ["New South Wales","Victoria","Queensland","Western Australia"]
};

function populateStates() {
    const countrySelect = document.getElementById("customer-country");
    const stateSelect = document.getElementById("customer-state");
    const selectedCountry = countrySelect.value;
    stateSelect.innerHTML = "<option value=''>Select State</option>";
    if(selectedCountry && countryStates[selectedCountry]) {
        countryStates[selectedCountry].forEach(state => {
            const option = document.createElement("option");
            option.value = state;
            option.textContent = state;
            stateSelect.appendChild(option);
        });
    }
}

function loadCart() {
    let cart = JSON.parse(localStorage.getItem('sriRamaCart')) || [];
    const tbody = document.getElementById('cart-body');
    const emptyMsg = document.getElementById('empty-message');
    const table = document.getElementById('cart-table');
    let grandTotal = 0;
    tbody.innerHTML = '';

    if(cart.length === 0) {
        table.style.display = 'none';
        emptyMsg.style.display = 'block';
    } else {
        table.style.display = 'table';
        emptyMsg.style.display = 'none';
        cart.forEach((item, index) => {
            const itemTotal = item.price * item.qty;
            grandTotal += itemTotal;
            tbody.innerHTML += `<tr>
                <td>${item.name}</td>
                <td>₹${item.price}</td>
                <td>${item.qty}</td>
                <td>₹${itemTotal}</td>
                <td><button onclick="removeItem(${index})" class="remove-btn">X</button></td>
            </tr>`;
        });
    }
    document.getElementById('grand-total').innerText = grandTotal;
}

function removeItem(index) {
    let cart = JSON.parse(localStorage.getItem('sriRamaCart')) || [];
    cart.splice(index, 1);
    localStorage.setItem('sriRamaCart', JSON.stringify(cart));
    loadCart();
}

function clearCart() {
    localStorage.removeItem('sriRamaCart');
    loadCart();
}

function proceedUPIPayment() {
    let cart = JSON.parse(localStorage.getItem('sriRamaCart')) || [];
    if(cart.length === 0) { alert("Your cart is empty!"); return; }

    let totalAmount = 0;
    let cartDetails = "";
    cart.forEach(item => {
        const itemTotal = item.price * item.qty;
        totalAmount += itemTotal;
        cartDetails += `${item.name} - Qty: ${item.qty} - ₹${itemTotal}\n`;
    });

    const name = document.getElementById('customer-name').value.trim();
    const contact = document.getElementById('customer-contact').value.trim();
    const email = document.getElementById('customer-email').value.trim();
    const country = document.getElementById('customer-country').value.trim();
    const state = document.getElementById('customer-state').value.trim();
    const city = document.getElementById('customer-city').value.trim();
    const pincode = document.getElementById('customer-pincode').value.trim();
    const address = document.getElementById('customer-address').value.trim();

    if(!name || !contact || !email || !country || !state || !city || !pincode || !address){
        alert("Please fill all delivery details.");
        return;
    }

    const upiID = "709592492@ybl"; // Replace with your UPI ID
    const businessName = "JaiSriRamOils";
    const txnNote = "OrderPayment";
    const upiLink = `upi://pay?pa=${upiID}&pn=${encodeURIComponent(businessName)}&tn=${encodeURIComponent(txnNote)}&am=${totalAmount}&cu=INR`;

    const whatsappMsg = `New Order Received!\n\nProducts:\n${cartDetails}\nGrand Total: ₹${totalAmount}\n\nDelivery Details:\nName: ${name}\nContact: ${contact}\nEmail: ${email}\nCountry: ${country}\nState: ${state}\nCity: ${city}\nPincode: ${pincode}\nAddress: ${address}`;
    const whatsappLink = `https://wa.me/917095924929?text=${encodeURIComponent(whatsappMsg)}`;

    // Open WhatsApp in new tab
    window.open(whatsappLink, "_blank");

    // Show payment section dynamically
    const paymentDiv = document.getElementById("payment-section");
    if(paymentDiv) {
        paymentDiv.innerHTML = `
            <h4>Pay ₹${totalAmount} via UPI</h4>
            <p>UPI ID: <strong>${upiID}</strong></p>
            <a href="${upiLink}" target="_blank" class="checkout-btn">Pay Now</a>
        `;
        paymentDiv.style.display = "block";
    }
}


window.onload = loadCart;
</script>
</body>
</html>
